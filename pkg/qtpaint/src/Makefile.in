QTBASE_DIR := $(shell Rscript -e 'cat(system.file(package="qtbase"))')

all:
	cmake ../inst/kdebindings/CMakeLists.txt \
	      -DCMAKE_INSTALL_PREFIX=../local -DQTBASE_DIR=$(QTBASE_DIR) \
	      -DR_INCLUDE_DIR=$(R_INCLUDE_DIR)
	LD_LIBRARY_PATH=${QTBASE_DIR}/kdebindings/generator/bin \
		make -C ../inst/kdebindings install
	cmake CMakeLists.txt \
	      -DR_LIBRARIES="${LIBR}" \
	      -DR_INCLUDES=${R_INCLUDE_DIR} \
	      -DQTBASE_DIR=${QTBASE_DIR}
	make
	cp Makefile Makefile.clean
	cp Makefile.in Makefile

clean:
	if test -e Makefile.clean; then make -f Makefile.clean clean; fi
	make -C ../inst/kdebindings clean
	rm -rf ../local
